"use strict";class PsyTestsCalculator{constructor(t){this.handler=t,this.errCSS="color: red; border: 2px solid red; font-weight: bold;",this.init()}init(){this.handler.getResult?(this.el=document.querySelector(".js-psy-test-body"),this.el?(this.groups=this.el.querySelectorAll(".js-psy-test-group"),this.groups.length||this._errorMsg(" Не найден селектор .js-psy-test-group")):this._errorMsg(" Не найден селектор .js-psy-test-body")):this._errorMsg(" Не задана функция для возвращения результата теста ")}calc(){let t=0;const s={},e=this.groups.length;for(let i=0;i<e;i++){const e=this.groups[i],n=Array.from(e.querySelectorAll(".js-psy-test-input"));if(!n.length)throw this._errorMsg(" Не найден селектор .js-psy-test-input"),"Некорректная HTML структура теста BecksAlarmScale";n.find((t=>t.checked))||(e.classList.add("_error"),s.error="Не выбран ответ в группе"),s.error||n.forEach((s=>{s.checked?(t+=+s.value,s.setAttribute("checked",!0)):s.setAttribute("disabled",!0)}))}return s.error?(s.errTarget=this.el.querySelector(".js-psy-test-group._error"),s):this.handler.getResult(t)}_errorMsg(t=""){console.log(`%c "${t}" `,this.errCSS),alert("К сожалению тест сломался. Сообщите об этом владельцу сайта, пожалуйста!")}}class PsyTestsManager{constructor(t){this.handler=t,this.errCSS="color: red; border: 2px solid red; font-weight: bold;",this.init()}init(){if(this.el=document.querySelector(".js-psy-test"),this.el){if(this.testName=this.el.getAttribute("data-test-name"),this.testName||this._errorMsg('Не задано имя теста в data атрибуте блока ".js-psy-test"'),"object"!=typeof this.handler)return this._errorMsg(`Ошибка класса обработчика теста: ${this.testName}. Класс не найден.`),void console.log(e);this.inputs=this.el.querySelectorAll(".js-psy-test-input"),this.calcBtn=this.el.querySelector(".js-psy-test-btn-calc"),this.resultContainer=this.el.querySelector(".js-psy-test-result"),this.saveBtn=this.el.querySelector(".js-psy-test-btn-save"),this.againBtn=this.el.querySelector(".js-psy-test-btn-again");for(let t in this)if(!this[t])return void this._errorMsg(`Ошибка инициализации PsyTestsManager. Не задано поле: ${t}`);this.style=document.querySelector(".js-psy-test-style"),this.againBtn.href=location.href,this.calcBtn.addEventListener("click",(()=>{this._calc()})),this.saveBtn.addEventListener("click",(()=>{this._save()})),this.inputs.forEach((t=>t.addEventListener("change",(()=>{const s=t.closest(".js-psy-test-group._error");s&&(s.classList.remove("_error"),setTimeout((()=>{const t=this.el.querySelector(".js-psy-test-group._error,  .js-psy-test-footer");t&&t.scrollIntoView(!0)}),10))}))))}else this._errorMsg('%c Не найден селектор ".js-psy-test" ')}_calc(){let t={};try{t=this.handler.calc()}catch(t){return this._errorMsg(`Ошибка вычисления теста ${this.testName}`),console.log(t),!1}if(t.error)return t.errTarget&&t.errTarget.scrollIntoView(!0),!1;if(!t.modifier||!t.html)throw this._errorMsg(),` Ошибка вычисления результата теста ${this.testName}. `;this.calcBtn.remove(),this.resultContainer.innerHTML=t.html,this.resultContainer.classList.add(`psy-test__info--${t.modifier}`),this.resultContainer.classList.remove("_hidden"),this.againBtn.classList.remove("_hidden"),this.saveBtn.classList.remove("_hidden"),this.againBtn.href=location.href,this.resultContainer.scrollIntoView()}_save(){if(this.saveBtn.remove(),!this.style)return alert("К сожалению невозможно сохранить тест. \n\nСообщите об этом владельцу сайта, пожалуйста!"),void console.log("%c Не найдены стили для сохранения ",this.errCSS);this.style.className="";let t=this.el.getAttribute("data-test-link");const s=this.againBtn.href;this.againBtn.href=t||location.origin;let e=` <!DOCTYPE html>\n\t\t\t\t\t<html lang="ru">\n\t\t\t\t\t\t<head>\n\t\t\t\t\t\t\t\x3c!-- WEB-разработчик данного теста - Дмитрий Богданов https://bdemetrix.github.io --\x3e\n\t\t\t\t\t\t\t<title>@@title</title>\n\t\t\t\t\t\t\t<meta charset="UTF-8">\n\t\t\t\t\t\t\t<meta name="format-detection" content="telephone=no">\n\t\t\t\t\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">\n\t\t\t\t\t\t\t${this.style.outerHTML}\n\t\t\t\t\t\t</head>\n\t\t\t\t\t\t<body class = "_container">\n\t\t\t\t\t\t\t${this.el.outerHTML}\n\t\t\t\t\t\t\t<scr`;e+="ipt>\n\t\t\t\tdocument.getElementById('psy-test-result').scrollIntoView(true);\n\t\t\t\t</scr",e+="ipt>\n\t\t\t\t\t\t</body>\n\t\t\t\t\t</html>",this.againBtn.href=s;let i=this.el.getAttribute("data-test-file-name")??"Test.";i=`${i} от ${this._getDate()}.html`;const n=new Blob([e],{type:"text/plain"}),r=document.createElement("a");r.setAttribute("href",URL.createObjectURL(n)),r.setAttribute("download",i),r.click()}_getDate(){let t=new Date,s=t.getFullYear(),e=t.getMonth()+1;e=e<10?"0"+e:e;let i=t.getDate();i=i<10?"0"+i:i;let n=t.getHours();n=n<10?"0"+n:n;let r=t.getMinutes();return r=r<10?"0"+r:r,`${i}.${e}.${s}  ${n}.${r}`}_errorMsg(t){console.log(`%c ${t} `,this.errCSS),alert("К сожалению тест сломался. \n\nСообщите об этом Инне Моисеевой, пожалуйста! \n\n telegram: @innasteplom")}}class BecksAlarmScale{constructor(){this.init()}init(){try{const t=new PsyTestsCalculator(this);new PsyTestsManager(t)}catch(t){throw alert("К сожалению тест сломался. \n\nСообщите об этом Инне Моисеевой, пожалуйста! \n\n telegram: @innasteplom"),t}}getResult(t=0){const s=Math.floor(1e4*t/63)/100,e=`\n        <div class = "psy-test__info-scale">\n            <div class = "psy-test__info-scale-wrap">\n                <div class="psy-test__info-scale-cells" style = "background-size: ${Math.floor(1e4/63)/100}%, 100%;"></div> \n                <div class="psy-test__info-scale-marker" style="width: ${s}%;" ></div>\n                <div class="psy-test__info-scale-cover"></div> \n            </div> \n            <div class="psy-test__info-scale-map">\n                <div class="psy-test__info-scale-item" style="width: 33.33%;">\n                    <span>[ 0 </span><span>21 ]</span>\n                </div>\n                <div class="psy-test__info-scale-item" style="width: 21%;">\n                    <span>[ 22 </span><span>35 ]</span>\n                </div>\n                <div class="psy-test__info-scale-item" style="width: 45,67%;">\n                    <span>[ 36 </span><span>63 ]</span >\n                </div> \n            </div> \n        </div> `,i={};return t>36?(i.modifier="red",i.html=`Потенциально опасный уровень беспокойства и&nbsp;тревоги <div class="psy-test__info-count">Набранных баллов: ${t} </div>`+e):t>22?(i.modifier="yellow",i.html=`Cредняя тревожность <div class="psy-test__info-count">Набранных баллов: ${t} </div>`+e):(i.modifier="green",i.html=`Низкая тревожность <div class="psy-test__info-count">Набранных баллов: ${t}</div>`+e),i}}class BecksDepressionScale{constructor(){this.init()}init(){try{const t=new PsyTestsCalculator(this);new PsyTestsManager(t)}catch(t){throw alert("К сожалению тест сломался. \n\nСообщите об этом Инне Моисеевой, пожалуйста! \n\n telegram: @innasteplom"),t}}getResult(t=0){const s=Math.floor(1e4*t/63)/100,e=`\n        <div class = "psy-test__info-scale">\n            <div class = "psy-test__info-scale-wrap">\n                <div class="psy-test__info-scale-cells" style="background-size: ${Math.floor(1e4/63)/100}%, 100%;"></div> \n                <div class="psy-test__info-scale-marker" style="width: ${s}%;" ></div>\n                <div class="psy-test__info-scale-cover"></div> \n            </div> \n            <div class="psy-test__info-scale-map psy-test__info-scale-map--min">\n                <div class = "psy-test__info-scale-item" style="width: 14.29%;">\n                    <span>[ 0 </span><span>9 ]</span>\n                </div>\n                <div class="psy-test__info-scale-item" style="width: 14.29%;">\n                    <span>[ 10 </span><span>18 ]</span>\n                </div> \n                <div class = "psy-test__info-scale-item" style="width: 17.46%;">\n                    <span> [19 </span><span>29 ]</span >\n                </div>\n                <div class = "psy-test__info-scale-item" style="width: 53.96%;">\n                    <span>[ 30 </span><span>63 ]</span >\n                </div> \n            </div> \n        </div> `,i={};return t>29?(i.modifier="red",i.html=`Тяжелая депрессия <div class="psy-test__info-count">Набранных баллов: ${t} </div>`+e):t>18?(i.modifier="orange",i.html=`Выраженная депрессия (депрессия средней тяжести) <div class="psy-test__info-count">Набранных баллов: ${t} </div>`+e):t>9?(i.modifier="yellow",i.html=`От легкой до&nbsp;умеренной депрессии <div class="psy-test__info-count">Набранных баллов: ${t} </div>`+e):(i.modifier="green",i.html=`Нормальное состояние <div class="psy-test__info-count">Набранных баллов: ${t}</div> `+e),i}}class BecksHopelessnessScale{constructor(){this.init()}init(){try{const t=new PsyTestsCalculator(this);new PsyTestsManager(t)}catch(t){throw alert("К сожалению тест сломался. \n\nСообщите об этом Инне Моисеевой, пожалуйста! \n\n telegram: @innasteplom"),t}}getResult(t=0){const s=Math.floor(1e4*t/63)/100,e=`\n        <div class = "psy-test__info-scale">\n            <div class = "psy-test__info-scale-wrap">\n                <div class="psy-test__info-scale-cells" style="background-size: ${Math.floor(1e4/63)/100}%, 100%;"></div> \n                <div class="psy-test__info-scale-marker" style="width: ${s}%;" ></div>\n                <div class="psy-test__info-scale-cover"></div> \n            </div> \n            <div class="psy-test__info-scale-map psy-test__info-scale-map--min">\n                <div class = "psy-test__info-scale-item" style="width: 14.29%;">\n                    <span>[ 0 </span><span>9 ]</span>\n                </div>\n                <div class="psy-test__info-scale-item" style="width: 14.29%;">\n                    <span>[ 10 </span><span>18 ]</span>\n                </div> \n                <div class = "psy-test__info-scale-item" style="width: 17.46%;">\n                    <span> [19 </span><span>29 ]</span >\n                </div>\n                <div class = "psy-test__info-scale-item" style="width: 53.96%;">\n                    <span>[ 30 </span><span>63 ]</span >\n                </div> \n            </div> \n        </div> `,i={};return t>29?(i.modifier="red",i.html=`Тяжелая депрессия <div class="psy-test__info-count">Набранных баллов: ${t} </div>`+e):t>18?(i.modifier="orange",i.html=`Выраженная депрессия (депрессия средней тяжести) <div class="psy-test__info-count">Набранных баллов: ${t} </div>`+e):t>9?(i.modifier="yellow",i.html=`От легкой до&nbsp;умеренной депрессии <div class="psy-test__info-count">Набранных баллов: ${t} </div>`+e):(i.modifier="green",i.html=`Нормальное состояние <div class="psy-test__info-count">Набранных баллов: ${t}</div> `+e),i}}