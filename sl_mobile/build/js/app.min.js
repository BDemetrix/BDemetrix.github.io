let isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};isMobile.any()?document.body.classList.add("_touch"):document.body.classList.remove("_touch");const bodyGlobal=document.querySelector("body"),scrollWidth=window.innerWidth-document.documentElement.clientWidth;function blockOverflow(){bodyGlobal.style.overflow="hidden",bodyGlobal.style.touchAction="none",isMobile.any()||(bodyGlobal.style.paddingRight=scrollWidth+"px")}function unBlockOverflow(e=400){bodyGlobal.style.overflow="",bodyGlobal.style.touchAction="",bodyGlobal.style.paddingRight="",console.log("unBlockOverflow")}function toggleOverflow(){"hidden"!=window.getComputedStyle(bodyGlobal).overflow?blockOverflow():unBlockOverflow()}function initSpollers(e){e.length&&e.forEach((e=>{let t=!0;const o=e.dataset.spollerMaxwidth,s=e.classList.contains("_one");let n=e.querySelectorAll("._spoller");n.length&&n.forEach(((e,n,i)=>{e.addEventListener("click",(function(){if(t){if(t=!1,o&&window.innerWidth>o)return!1;s&&i.forEach((t=>{t!=e&&(t.classList.remove("_active"),_slideUp(t.nextElementSibling,400))})),e.classList.toggle("_active"),_slideToggle(e.nextElementSibling,400),setTimeout((function(){t=!0}),400)}}))}))}))}function clearSpollersStyle(){let e=document.querySelectorAll("._spollers");e.length&&e.forEach((e=>{const t=e.dataset.spollerMaxwidth;if(t&&window.innerWidth>t){let t=e.querySelectorAll("._spoller");t.length&&t.forEach((e=>{e.classList.remove("_active"),e.nextElementSibling.style.display=""}))}}))}initSpollers(document.querySelectorAll("._spollers")),window.addEventListener("resize",clearSpollersStyle);let _slideUp=(e,t=500)=>{e.style.transitionProperty="height, margin, padding, opacity",e.style.transitionDuration=t+"ms",e.style.height=e.offsetHeight+"px",e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.style.opacity=0,window.setTimeout((()=>{e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.style.removeProperty("opacity"),e.classList.remove("_slide")}),t)},_slideDown=(e,t=500)=>{e.style.removeProperty("display");let o=window.getComputedStyle(e).display;"none"===o&&(o="block"),e.style.display=o;let s=e.offsetHeight;e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.transitionProperty="height, margin, padding, opacity",e.style.transitionDuration=t+"ms",e.style.height=s+"px",e.style.opacity=1,e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout((()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.style.removeProperty("opacity"),e.classList.remove("_slide")}),t)},_slideToggle=(e,t=500)=>{if(!e.classList.contains("_slide"))return e.classList.add("_slide"),"none"===window.getComputedStyle(e).display?_slideDown(e,t):_slideUp(e,t)};function plugSimpleBar(e){let t;if("string"==typeof e)t=document.querySelector(e);else{if("object"!=typeof e)return;t=e}if(t)try{return new SimpleBar(t)}catch{t.style.ovetflowY="auto"}}function closeAllOpenedMenu(){document.querySelectorAll("._open").forEach((e=>e.classList.remove("_open")))}document.documentElement.addEventListener("click",(e=>{e.target.closest("body")&&!e.target.closest("._open")&&(closeAllOpenedMenu(),unBlockOverflow())}));let activeHeadersEls=document.querySelectorAll("._active-el");activeHeadersEls.forEach((e=>{e.addEventListener("click",(()=>{e.parentElement.classList.contains("_open")||closeAllOpenedMenu(),e.parentElement.classList.toggle("_open")}))}));let inputArr=document.querySelectorAll("._input");inputArr.length&&inputArr.forEach((e=>{e.addEventListener("focus",(()=>{e.parentElement.classList.add("_focus")})),e.addEventListener("blur",(()=>{e.parentElement.classList.remove("_focus")})),e.addEventListener("change",(()=>{e.value?e.parentElement.classList.add("_filled"):e.parentElement.classList.remove("_filled")}))}));let tabs=document.querySelectorAll("._tabs");for(let t=0;t<tabs.length;t++){let o=tabs[t],s=o.querySelectorAll("._tabs-item"),n=o.querySelectorAll("._tabs-block");for(let i=0;i<s.length;i++){let l=s[i];l.addEventListener("click",(function(e){for(let e=0;e<s.length;e++){s[e].classList.remove("_active"),n[e].classList.remove("_active")}l.classList.add("_active"),n[i].classList.add("_active"),e.preventDefault()}))}}const popUpMenu=document.querySelectorAll(".context-menu");if(popUpMenu.length){function popUpMenuCorrectPos(e){if(!e)return;popUpMenuCleartPos(e);const t=e.querySelector("ul");if(!t)return;let o=e.getBoundingClientRect().left,s=e.getBoundingClientRect().right,n=t.getBoundingClientRect().left-5,i=document.documentElement.clientWidth-t.getBoundingClientRect().right-5;n<0&&(document.documentElement.clientWidth-o-5>=t.offsetWidth?t.style.left="0":t.style.right=n+"px"),i<0&&(s-5>=t.offsetWidth?t.style.right="0":t.style.left=i+"px")}function popUpMenuCleartPos(e){const t=e.querySelector("ul");t&&(t.style.left=t.style.right="")}document.documentElement.addEventListener("click",(function(e){if(e.target.closest(".context-menu > button, .context-menu > a")){let t=e.target.closest(".context-menu");t&&(t.classList.contains("_open")||closeAllOpenedMenu(),popUpMenuCorrectPos(t),t.classList.toggle("_open"))}else{let e=document.querySelector(".context-menu._open");e&&e.classList.remove("_open")}}),!1),window.addEventListener("resize",(()=>{popUpMenu.forEach((e=>{popUpMenuCleartPos(e),popUpMenuCorrectPos(e)}))}))}document.documentElement.addEventListener("input",(function(e){e.target.matches(".js-textarea-auto-height")&&(e.target.style.height="",e.target.style.height=e.target.scrollHeight+2+"px")}),!0);const textareaAutoHeight=document.querySelectorAll(".js-textarea-auto-height");textareaAutoHeight.forEach((e=>{e.getBoundingClientRect().height<e.scrollHeight&&(e.style.height=e.scrollHeight+2+"px")})),window.addEventListener("resize",(function(e){document.querySelectorAll(".js-textarea-auto-height").forEach((e=>{e.dispatchEvent(new Event("input"))}))}),!1);const fieldFocus=document.querySelectorAll(".js-focus");fieldFocus.length&&fieldFocus.forEach((e=>{e.addEventListener("focus",(function(){this.parentElement.classList.add("_focus")})),e.addEventListener("blur",(function(){this.parentElement.classList.remove("_focus")}))}));let arrowToTop=document.querySelector(".arrow-to-top");function numOnly(e){46==e.keyCode||8==e.keyCode||9==e.keyCode||27==e.keyCode||13==e.keyCode||65==e.keyCode&&!0===e.ctrlKey||e.keyCode>=35&&e.keyCode<=39||(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}arrowToTop&&(window.addEventListener("scroll",(()=>{arrowToTop.classList.toggle("arrow-to-top--visible",window.scrollY>250)})),arrowToTop.addEventListener("click",(()=>{window.scrollTo(0,0)})));let mainHeader=document.querySelector("header.header"),headerMenuBody=document.querySelector(".header .menu__body"),mainMenuSimpleBar=plugSimpleBar(".header .menu__body");mainMenuSimpleBar.recalculate(),window.addEventListener("resize",(()=>{mainMenuSimpleBar&&mainMenuSimpleBar.recalculate()}));const mainMenuBtn=document.getElementById("main-menu-btn");mainMenuBtn&&mainMenuBtn.addEventListener("click",(e=>{e.target.closest("._open")?blockOverflow():unBlockOverflow()}));let alphabet=document.querySelector(".alphabet"),searchInput=document.querySelector(".query-search__input");searchInput&&(searchInput.addEventListener("focus",(()=>{searchInput.classList.add("_focus"),searchInput.parentElement.classList.add("_focus"),alphabet&&alphabet.classList.add("_show")})),searchInput.addEventListener("blur",(()=>{const e=searchInput.parentElement;setTimeout((()=>{alphabet&&alphabet.classList.remove("_show"),searchInput.classList.remove("_focus"),e.classList.remove("_focus"),searchInput.value=""}),200)})));let searchIcon=document.querySelector(".query-search__icon");searchIcon&&searchIcon.addEventListener("click",(()=>{searchInput.focus()}));let arrowInputBtn=document.querySelector(".query-search__input-arrow");arrowInputBtn&&arrowInputBtn.addEventListener("click",(()=>{setTimeout((()=>{searchInput.focus()}),210)}),!1);let notifySimpleBar=plugSimpleBar("#notify-body");const darkTheme=document.querySelector(".js-dark-theme");if(darkTheme){const r=!!window.localStorage.getItem("darkTheme");darkTheme.checked=r,document.body.classList.toggle("dark-theme",r),darkTheme.addEventListener("change",(()=>{document.body.classList.toggle("dark-theme"),window.localStorage.setItem("darkTheme",darkTheme.checked?"1":"")}))}let categoriesSlider,now=new Date,slideDate=document.querySelector(".slide-content__date");slideDate&&(slideDate.textContent=`${now.getDate()}.${now.getMonth()<9?"0"+(now.getMonth()+1):now.getMonth()+1}.${now.getFullYear()}`);const categoriesSliderBbody=document.querySelector(".categories-slider__body");let contentSlider;categoriesSliderBbody&&(categoriesSliderBbody.classList.remove("categories-slider__body--loading"),categoriesSlider=new Swiper(categoriesSliderBbody,{slidesPerView:"auto",spaceBetween:32,speed:400,observer:!0,resizeObserver:!0,watchOverflow:!0,mousewheel:{releaseOnEdges:!0}}));const contentSliderBbody=document.querySelector(".content-slider__body");categoriesSliderBbody&&(categoriesSliderBbody.classList.remove("content-slider__body--loading"),contentSlider=new Swiper(contentSliderBbody,{thumbs:{swiper:categoriesSlider},slidesPerView:1,speed:400,simulateTouch:!0,observer:!0,resizeObserver:!0,watchOverflow:!0})),function(){const e=document.querySelector(".sections-box__swiper");if(!e)return;e.parentElement.classList.remove("_loading");const t=Array.from(e.querySelectorAll(".sections-box__item")),o=t.findIndex((e=>e.classList.contains("sections-box__item--active"))),s=new Swiper(e,{slidesPerView:"auto",watchOverflow:!0,observer:!0,resizeObserver:!0,freeMode:{enabled:!1},speed:300,navigation:{nextEl:".sections-box__next",prevEl:".sections-box__prev"}});s.slideTo(o),t.forEach(((e,t,o)=>{e.addEventListener("click",(()=>{o.forEach((e=>{e.classList.remove("sections-box__item--active")})),e.classList.add("sections-box__item--active"),s.slideTo(t);const n=e.querySelector("a");s.isLocked&&n&&(console.log("selectorLinksSlider.isLocked = ",s.isLocked),window.location=n.href)}))}))}();const forumsSlider=new Swiper(".forums-slider",{speed:400,autoplay:{delay:3e3},loop:!0,watchOverflow:!0,observer:!0,resizeObserver:!0,spaceBetween:20,breakpoints:{280:{slidesPerView:3.5},320:{slidesPerView:4.5},430:{slidesPerView:5.5},540:{slidesPerView:6.5},650:{slidesPerView:7.5},760:{slidesPerView:8.5}}});!function(){const e=".custom-select";function t(t){document.querySelectorAll(e).forEach((function(e){e!=t&&e.classList.remove("custom-select--opened")}))}document.documentElement.addEventListener("click",(function(o){const s=o.target.closest(e);if(!s)return t(null);if(o.target.closest(".custom-select__main-btn"))s.classList.toggle("custom-select--opened"),t(s);else if(nOption=o.target.closest(".custom-select__option")){const e=s.querySelector(".custom-select__main-btn");e&&(e.value=nOption.value),s.classList.remove("custom-select--opened"),e.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!1}))}}),!1),document.documentElement.addEventListener("sync",(function(t){if(!t.target.matches(e))return;const o=t.target,s=o.querySelector(".custom-select__main-btn");if(s){const e=o.querySelector(".custom-select__option--active");if(e)s.textContent=e.textContent,s.value=e.value;else{const e=o.querySelector('.custom-select__option[value="'+s.value+'"]');e&&e.classList.add("custom-select__option--active")}Object.defineProperty(s,"value",{set:function(e){this.setAttribute("value",e);const t=o.querySelector(".custom-select__option--active"),s=o.querySelector('.custom-select__option[value="'+this.value+'"]');t!==s&&(t&&t.classList.remove("custom-select__option--active"),s&&s.classList.add("custom-select__option--active"),this.textContent=s?s.textContent:"")},get:function(){return this.getAttribute("value")}})}}),!1),document.querySelectorAll(e).forEach((function(e){e.dispatchEvent(new Event("sync",{bubbles:!0,cancelable:!1}))})),"function"==typeof MutationObserver&&new MutationObserver((function(t){t.forEach((function(t){t.addedNodes.forEach((function(t){if(t.matches&&t.matches(e))t.dispatchEvent(new Event("sync",{bubbles:!0,cancelable:!1}));else if(t.querySelectorAll){const o=t.querySelectorAll(e);o.length&&o.forEach((function(e){e.dispatchEvent(new Event("sync",{bubbles:!0,cancelable:!1}))}))}}))}))})).observe(document.documentElement,{childList:!0,subtree:!0})}(),function(){const e=document.querySelector(".js-nf-filter-btn"),t=document.querySelector(".js-nf-filter-body");e&&t&&e.addEventListener("click",(()=>{_slideToggle(t,300)}))}(),function(){const e=document.querySelector(".js-news-feed-list");if(!e)return;function t(e){e.querySelectorAll(".js-news-card-author").forEach((e=>{const t=e.parentElement,o=t.querySelector(".js-news-card-date");if(o){const s=t.offsetWidth,n=o.offsetWidth;e.style.maxWidth=s-n+"px"}else e.style.maxWidth="100%"}))}if(document.documentElement.addEventListener("click",(e=>{const t=e.target.closest(".js-news-card-author");t&&(e.preventDefault(),window.location.href=t.dataset.href)})),t(e),window.addEventListener("resize",(()=>{t(e)}),!1),window.addEventListener("orientationchange",(()=>{t(e)}),!1),!window.hasOwnProperty("MutationObserver"))return;new MutationObserver((o=>{o.forEach((function(o){o.addedNodes.length&&t(e)}))})).observe(e,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})}(),function(e){e.fn.datepicker.dates.ru={days:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],daysShort:["Вск","Пнд","Втр","Срд","Чтв","Птн","Суб","Вск"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб","Вс"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],today:"Сегодня",clear:"Убрать дату",weekStart:1},e.fn.datepicker.defaults.format="dd.mm.yyyy",e.fn.datepicker.defaults.language="ru",e.fn.datepicker.defaults.autoclose=!0,e.fn.datepicker.defaults.todayHighlight=!0}(jQuery),function(){const e=document.querySelector(".js-slide-sidebar"),t=document.querySelectorAll(".js-slide-sidebar-toggle-btn");e&&t.length&&t.forEach((t=>{t.addEventListener("click",(()=>{e.classList.toggle("slide-sidebar--opened")}))}))}(),function(){const e=document.querySelector(".quick-comment"),t=document.querySelector(".quick-comment__btn"),o=document.querySelector(".quick-comment__cover"),s=document.querySelector(".quick-comment__send"),n=document.querySelector(".quick-comment__text");e&&t&&o&&s&&n&&(t.addEventListener("click",(()=>{e.classList.add("quick-comment--visible"),n.focus(),blockOverflow()})),o.addEventListener("click",(()=>{e.classList.remove("quick-comment--visible","_open"),unBlockOverflow()})),s.addEventListener("click",(()=>{e.classList.remove("quick-comment--visible","_open"),n.value="",n.style.height="",unBlockOverflow()})))}(),function(){const e=document.querySelector(".js-post-head"),t=document.querySelector(".js-post-head-menu");(e||t)&&e.addEventListener("mouseleave",(()=>{t.classList.remove("_open")}))}(),function(){const e=document.querySelector(".selector-links__slider");if(!e)return;const t=Array.from(e.querySelectorAll(".selector-links__item")),o=t.findIndex((e=>e.classList.contains("._active")));e.parentElement.classList.remove("_loading");const s=new Swiper(e,{slidesPerView:"auto",watchOverflow:!0,observer:!0,resizeObserver:!0,freeMode:{enabled:!0},speed:300,navigation:{nextEl:".selector-links__next",prevEl:".selector-links__prev"}});s.slideTo(o),t.forEach(((e,t,o)=>{e.addEventListener("click",(()=>{o.forEach((e=>{e.classList.remove("_active")})),e.classList.add("_active"),s.slideTo(t);e.querySelector("a")}))}))}(),function(){let e;const t=document.querySelector(".navbar__wrap");t&&(t.parentElement.classList.remove("_loading"),e=new Swiper(t,{slidesPerView:"auto",watchOverflow:!0,freeMode:{enabled:!0,sticky:!0},speed:300,navigation:{nextEl:".navbar__next",prevEl:".navbar__prev"}})),new jBox("Tooltip",{attach:".navbar__drop-item",zIndex:999,adjustPosition:!0,isolateScroll:!1,closeOnMouseleave:!0,animation:"move",addClass:"navbar-jBox",onOpen:function(){let e=this.target[0].nextElementSibling.innerHTML;this.setContent(e)}})}(),setTimeout((()=>{new FlexTable(".trades-table")}),300),function(){plugSimpleBar(".qn-filters__content");document.querySelectorAll(".qn-menu__mob-tabs a").forEach((e=>{e.addEventListener("click",(e=>{e.stopPropagation()}))}));const e=document.querySelector(".qn-menu__btn--filter"),t=document.querySelector(".qn-filters"),o=document.querySelector(".qn-filters__close");if(e&&t&&o&&(e.addEventListener("click",(t=>{e.parentElement.classList.add("_opened")})),t.addEventListener("click",(e=>{e.target.closest(".qn-filters__content")&&!e.target.closest(".qn-filters__close")||t.closest("._opened").classList.remove("_opened")}))),t){const e=document.querySelector(".qn-filters__content"),o=t.querySelectorAll("input");let s=new Event("change");e&&e.addEventListener("reset",(e=>{o.forEach((e=>{setTimeout((()=>{e.dispatchEvent(s),$.each(n,(function(){this.sumo.unSelectAll(),this.sumo.selectItem(0)})),$("#sector_id")[0].sumo.unSelectAll()}),50)}))}))}$("#sector_id").length&&$("#sector_id").SumoSelect({placeholder:"Все сектора",csvDispCount:2,captionFormat:"Сектора ({0})"});var s,n=$("#country_id, #val_middle_gt, #val_middle_lt, #capitalization_gt, #capitalization_lt, #is_state_owned, #is_exporter, #year, #type, #quarter, #duration_lt_id, #duration_gt_id, #mat_years_lt_id, #mat_years_gt_id, #year_yield_lt_id, #year_yield_gt_id, #ofz_type_id");n.length&&n.SumoSelect(),function(){let e=document.querySelectorAll(".optWrapper");e.length&&e.forEach((e=>{plugSimpleBar(e)}))}(),(s=$(".SumoSelect > .optWrapper.multiple .options li.opt")).length&&(s.append('<button class="radio-sumo-btn" type="button"></button>'),$(".radio-sumo-btn").on("click",(function(e){e.stopPropagation();var t=$(this).closest(".optWrapper");$(this).closest(".SumoSelect").find("select")[0].sumo.unSelectAll(),t.find(".options li.opt").removeClass("selected"),$(this).parent().trigger("click"),$(this).addClass("selected")})),s.on("click",(function(){$(this).closest(".optWrapper").find(".radio-sumo-btn").removeClass("selected")})));let i=[];document.querySelectorAll(".qn-filters__range-slider").forEach((e=>{i.push({target:e,settings:{start:[1,1e3],margin:10,connect:!0,range:{min:[0],max:[1e3]}},wNumbFormat:wNumb({decimals:0,thousand:"",suffix:"М ₽"})})})),i.forEach((e=>function(e){if(!(e&&e.target&&e.settings&&e.wNumbFormat))return void console.log("Плагин NoUiSlider не може быть подключен. function plugNoUiSlider(obj)");let t;if("string"==typeof e.target)t=document.querySelector(e.target);else{if("object"!=typeof e.target)return void console.log("Плагин NoUiSlider не може быть подключен. Не определен целевой объект");t=e.target}if(t){const n=t.parentElement.querySelectorAll("input");function o(){let t=Number(e.wNumbFormat.from(this.value));this.value=e.wNumbFormat.to(t)}function s(){let e=[];n.forEach((t=>e.push(t.value))),t.noUiSlider.set(e)}slider=noUiSlider.create(t,{...e.settings,format:e.wNumbFormat}),n&&(slider.on("slide",(e=>{n.forEach(((t,o)=>{t.value=e[o]}))})),n.forEach((e=>{e.addEventListener("keydown",numOnly),e.addEventListener("blur",o),e.addEventListener("focus",(e=>{e.target.select()})),e.addEventListener("change",s),e.focus(),e.blur()})))}}(e))),setTimeout((()=>{new FlexTable(".trades-table")}),300)}(),new jBox("Tooltip",{theme:"trades-table",attach:".js-trades-table-tooltip",adjustPosition:!0,isolateScroll:!1,animation:"move",position:{x:"center",y:"bottom"},offset:{y:10},maxWidth:250,trigger:"click"});class Tooltips{constructor(e={}){this.selector=e.selector??".smart-tooltip",this.attach=e.attach??".smart-tooltip",this.openTrigger=e.openTrigger??"mouseenter",this.closeTrigger=e.closeTrigger??"mouseleave",this.content=e.content??"title",this.contentSource=e.contentSource??null,this.getContent=e.getContent??null,this.offset=e.offset??"",this.hasPointer=e.hasPointer??!0,this.pointerSize=e.pointerSize??"",this.maxWidth=e.maxWidth??null,this.width=e.width??"",this.posMod={},this.posMod.x=e.posMod?.x??"center",this.posMod.y=e.posMod?.y??"auto",this.classMod={},this.isOpen=!1,this._init()}_init(){if(this.targets=document.querySelectorAll(this.attach),!this.targets.length)throw`Не найдены ноды по селектору ${this.attach}`;if(console.warn(this.targets),this.el=document.createElement("div"),this.el.className="js-tooltip",this.el.innerHTML='<div class="js-tooltip__container"></div> <div class="js-tooltip__pointer js-tooltip__pointer--bottom"></div>',document.body.append(this.el),this.container=this.el.querySelector(".js-tooltip__container"),this.pointer=this.el.querySelector(".js-tooltip__pointer"),this.contentSource&&"string"==typeof this.contentSource){const e=document.querySelector(this.contentSource);e&&(this.contentSourceEl=e,this.container.innerHTML="",this.container.append(e))}if(this.targets.forEach((e=>{"title"===this.content&&(e.dataset[this.content]=e.getAttribute(this.content),e.removeAttribute(this.content),this.maxWidth??=280,this.el.style.maxWidth=this.maxWidth+"px");e.addEventListener(this.openTrigger,(e=>{if("mouseenter"===e.type)return void this.open(e.target);const t=this.target;this.close(),t!=e.target&&this.open(e.target),setTimeout((()=>{}),10)})),"click"===this.openTrigger&&(this.closeTrigger="click"),"mouseleave"===this.closeTrigger&&e.addEventListener(this.closeTrigger,(e=>{this.close(e.target)}))})),"mouseleave"!==this.closeTrigger){const e=this.attach;document.documentElement.addEventListener("click",(t=>{t.target.closest(e)||t.target.closest(".js-tooltip")||this.close()}))}this._setProperty(),this.open(this.targets[0]),setTimeout((()=>{this.close()}),1)}open(t){this.target=t;let o="";if("title"===this.content)o=`<div class="js-tooltip__content">${t.dataset[this.content]}</div>`;else if(this.content)if(this.getContent||"function"!=typeof this.getContent){if(!this.contentSourceEl)return void this.show()}else o='<div class="js-tooltip__content">Загрузка...</div>',this._getContent(e);else o=this.content;o&&(this.container.innerHTML=o,this._calcPos(t),this._modClasses(),this.show())}close(){this.target=null,this.hide()}show(){this.el.classList.add("js-tooltip--shown"),setTimeout((()=>{this.isOpen=!0}),100)}hide(){this.el.classList.remove("js-tooltip--shown"),setTimeout((()=>{this.isOpen=!1}),100)}async _getContent(e){if(!this.getContent||"function"!=typeof this.getContent)return;const t=await this.getContent(e);t||(this.container.innerHTML=t)}_calcPos(e){const t=document.documentElement.clientWidth,o=e.getBoundingClientRect();this.hasPointer&&(this.pointer.style.left="");let s=this.el.offsetWidth,n=this.el.offsetHeight,i="auto",l="auto",r="auto",c="auto";o.top<n&&"auto"===this.posMod.y||"under"===this.posMod.y?(()=>{this.classMod.y="under",i=Math.ceil(o.bottom)})():(()=>{this.classMod.y="above",i=Math.ceil(o.top-n)})();const a=()=>(c="auto",this.hasPointer&&s>o.width&&setTimeout((()=>{this.pointer.style.left=this.el.offsetWidth-(o.width/2+this.pointerSize)+"px"}),50),l=t-o.right),d=()=>(l="auto",this.hasPointer&&s>o.width&&(this.pointer.style.left=o.width/2-this.pointerSize+"px"),c=o.left);switch(this.posMod.x){case"left":d();break;case"right":a();break;default:(()=>{l="auto";let e=Math.ceil(o.left-(s-o.width)/2);e+s>t?a():e<0?d():c=e})()}this.el.style.top="string"==typeof i?i:i+"px",this.el.style.right="string"==typeof l?l:l+"px",this.el.style.bottom=r,this.el.style.left="string"==typeof c?c:c+"px"}_verticalCalc(){}_modClasses(){switch(this.el.classList.remove("js-tooltip--top","js-tooltip--right","js-tooltip--bottom","js-tooltip--left"),this.pointer.classList.remove("js-tooltip__pointer--top","js-tooltip__pointer--right","js-tooltip__pointer--bottom","js-tooltip__pointer--left"),this.classMod.y){case"above":this.el.classList.add("js-tooltip--top"),this.pointer.classList.add("js-tooltip__pointer--bottom");break;case"under":this.el.classList.add("js-tooltip--bottom"),this.pointer.classList.add("js-tooltip__pointer--top")}}_setProperty(){this.offset&&this.el.style.setProperty("--offset",this.offset),this.hasPointer?this.pointerSize?this.el.style.setProperty("--pointer-size",this.pointerSize+"px"):this.pointerSize=parseFloat(window.getComputedStyle(this.el).getPropertyValue("--pointer-size"))??"":this.pointer.style.display="none",this.maxWidth&&(this.el.style.maxWidth=this.maxWidth),this.width&&(this.el.style.width=this.width)}}