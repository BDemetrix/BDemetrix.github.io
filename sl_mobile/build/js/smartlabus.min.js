document.body.addEventListener("keyup",(function(t){if("Escape"===t.key){const t=Array.from(document.querySelectorAll(".custom-pop-up--open"));t.length&&(t.sort((function(t,e){return e.style.zIndex-t.style.zIndex})),t[0].querySelector(".custom-pop-up__close").dispatchEvent(new Event("click",{bubbles:!0,cancelable:!1})))}}),!1),document.body.addEventListener("open-custom-pop-up",(function(t){"function"==typeof blockOverflow&&blockOverflow()}),!1),document.body.addEventListener("close-custom-pop-up",(function(t){document.querySelectorAll(".custom-pop-up--open").length||"function"!=typeof unBlockOverflow||unBlockOverflow()}),!1);class ModalDialog{options={id:null,class:null,title:null,content:null,onOpen:function(){},onClose:function(){}};dialog=null;constructor(t){if("object"==typeof t)for(var e in t)if(t.hasOwnProperty(e)&&void 0!==t[e]){if("__proto__"===e||this.options[e]===t[e])continue;this.options[e]=t[e]}this.dialogEvents=this._dialogEvents.bind(this)}setTitle(t,e){if(null!==t){var o="function"!=typeof t?t:t(e);"string"==typeof o&&this.dialog.querySelector(".custom-pop-up__title").insertAdjacentHTML("afterbegin",o),"object"!=typeof o||null===o||!("nodeType"in o)||1!==o.nodeType&&11!==o.nodeType||this.dialog.querySelector(".custom-pop-up__title").appendChild(o)}else{const t=this.dialog.querySelector(".custom-pop-up__title");if(t)for(;t.hasChildNodes();)t.removeChild(t.firstChild)}}setContent(t,e){if(null!==t){var o="function"!=typeof t?t:t(e);if(null!==o)return"string"==typeof o&&this.dialog.querySelector(".custom-pop-up__inner").insertAdjacentHTML("afterbegin",o),void("object"!=typeof o||!("nodeType"in o)||1!==o.nodeType&&11!==o.nodeType||this.dialog.querySelector(".custom-pop-up__inner").appendChild(o))}const n=this.dialog.querySelector(".custom-pop-up__inner");if(n)for(;n.hasChildNodes();)n.removeChild(n.firstChild)}open(t){if(this.dialog=document.createElement("div"),this.dialog.classList.add("custom-pop-up"),this.dialog.insertAdjacentHTML("afterbegin",'\t\t<div class="custom-pop-up__body">\t\t\t<div class="custom-pop-up__cover"></div>\t\t\t<div class="custom-pop-up__content">\t\t\t\t<button class="custom-pop-up__close"></button>\t\t\t\t<div class="custom-pop-up__title"></div>\t\t\t\t<div class="custom-pop-up__inner"></div>\t\t\t</div>\t\t</div>'),null!==this.options.id){var e="function"!=typeof this.options.id?this.options.id:this.options.id(t);"string"==typeof e&&this.dialog.setAttribute("id",e)}if(null!==this.options.class){var o="function"!=typeof this.options.class?this.options.class:this.options.class(t);if("string"==typeof o){const t=this.dialog.querySelector(".custom-pop-up__body"),e=this.dialog.querySelector(".custom-pop-up__content"),n=this.dialog.querySelector(".custom-pop-up__title"),s=this.dialog.querySelector(".custom-pop-up__inner");o.split(" ").forEach((function(o,i,c){this.dialog.classList.add(o),t.classList.add(o+"__body"),e.classList.add(o+"__content"),n.classList.add(o+"__title"),s.classList.add(o+"__inner")}),this)}}this.setTitle(this.options.title,t),this.setContent(this.options.content,t),document.body.appendChild(this.dialog),this.dialog.addEventListener("click",this.dialogEvents,!1);var n=1e3;const s=Array.from(document.querySelectorAll(".custom-pop-up--open")).map((t=>t.style.zIndex)).filter((t=>!!t&&"auto"!=t));s.length&&(n=Math.max.apply(null,s)),this.dialog.style.zIndex=n+1,this._onOpen(t),this.dialog.dispatchEvent(new Event("open-custom-pop-up",{bubbles:!0,cancelable:!1})),setTimeout(function(){this.dialog.classList.add("custom-pop-up--open","_open")}.bind(this),100)}close(){this.dialog.classList.remove("custom-pop-up--open","_open"),setTimeout(function(){this.dialog.dispatchEvent(new Event("close-custom-pop-up",{bubbles:!0,cancelable:!1})),this._onClose(),this.dialog.removeEventListener("click",this.dialogEvents,!1),document.body.removeChild(this.dialog)}.bind(this),300)}_onOpen(t){this.options.onOpen.call(this,t)}_onClose(){this.options.onClose.call(this)}_dialogEvents(t){return!("click"!==t.type||!t.target.classList.contains("custom-pop-up__close")&&!t.target.classList.contains("custom-pop-up__cover"))&&(t.stopPropagation(),this.close(),!0)}}class ConfirmDialog extends ModalDialog{confirmBtn=null;constructor(t){"string"!=typeof t.class&&(t.class="warning-popup"),"function"!=typeof t.onConfirm&&(t.onConfirm=function(){}),super(t)}setContent(t,e){const o=document.createElement("template");o.innerHTML='\t\t<div class="warning-popup__text"></div>\t\t<div class="warning-popup__btns">\t\t\t<button class="warning-popup__cancel-btn cancel-btn">Отмена</button>\t\t\t<button class="warning-popup__ok-btn blue-btn">ОК</button>\t\t</div>',o.content.querySelector(".warning-popup__text").insertAdjacentHTML("afterbegin",this.options.content),o.content.querySelector(".warning-popup__ok-btn").textContent=this.options.confirmText?this.options.confirmText:"OK",super.setContent(o.content,e)}open(t){super.open(t),setTimeout(function(){this.dialog.querySelector(".warning-popup__ok-btn").focus()}.bind(this),200)}_onOpen(t){this.confirmBtn=this.dialog.querySelector(".warning-popup__ok-btn"),super._onOpen(t)}_dialogEvents(t){return!!super._dialogEvents(t)||!("click"!==t.type||(t.target.classList.contains("warning-popup__ok-btn")&&this.options.onConfirm.call(this),!t.target.classList.contains("warning-popup__cancel-btn")))&&(t.stopPropagation(),this.close(),!0)}}function Confirm(t,e,o=null){return new Promise((function(n,s){var i=!1;new ConfirmDialog({class:"warning-popup",title:e,content:t,confirmText:o,onConfirm:function(){this.confirmBtn.disabled=!0,i=!0,this.close()},onClose:function(){return i?n():s()}}).open()}))}document.documentElement.addEventListener("click",(function(t){const e=t.target.closest(".auto-opener");if(e){const t=document.getElementById(e.dataset.targetId);if(t){const o={};t.classList.contains("custom-pop-up")?(o.class=function(){const e=[];return t.classList.forEach((function(t,o,n){"custom-pop-up"!==t&&e.push(t)})),e.join(" ")},o.title=function(){const e=t.querySelector(".custom-pop-up__title");return e?e.innerHTML:""},o.content=function(){const e=t.querySelector(".custom-pop-up__inner");return e?e.innerHTML:null}):(o.content=t.innerHTML,t.hasAttribute("title")&&(o.title=t.getAttribute("title")),t.hasAttribute("class")&&(o.class=t.getAttribute("class"))),e.classList.add("_open"),new ModalDialog(o).open()}}})),function(){const t=document.createElement("aside");t.classList.add("system-messages"),document.body.appendChild(t),t.addEventListener("click",(function(e){const o=e.target.closest(".system-messages__item");o&&(o.style.height="",o.classList.remove("system-messages__item--visible"),setTimeout((function(){t.removeChild(o)}),1e3))}),!1);const e=function(e){const o=document.createElement("div");o.classList.add("system-messages__item"),o.classList.add("system-messages__item--"+e.type),o.insertAdjacentHTML("afterbegin",'\t\t<div class="system-messages__item-inner">\t\t\t<div class="system-messages__title"></div>\t\t\t<div class="system-messages__text"></div>\t\t</div>');const n=o.querySelector(".system-messages__title");n&&("string"==typeof e.title?n.textContent=e.title:n.parentNode.removeChild(n));const s=o.querySelector(".system-messages__text");s&&("string"==typeof e.content?s.insertAdjacentHTML("afterbegin",e.content):s.parentNode.removeChild(s)),t.appendChild(o),o.style.height=o.querySelector(".system-messages__item-inner").offsetHeight+"px",o.classList.add("system-messages__item--visible"),"timeout"in e&&null!==e.timeout&&setTimeout((function(){o.dispatchEvent(new Event("click",{bubbles:!0,cancelable:!1}))}),e.timeout)};window.msgErrorBox={alert:function(t,o){e({title:t||"Ошибка!",content:o,type:"error",timeout:5e3})}},window.msgNoticeBox={alert:function(t,o){e({title:t||"Внимание!",content:o,type:"success",timeout:5e3})}}}();