(function(a){a(document).ready(function(){window.ban=function(h){var f=a("#user_ban_dialog");var g={id:"userBanDialog",title:"Предупреждение пользователя",confirmButton:"ОК",cancelButton:"Отмена",content:f,confirm:function(){var i=this;
var m={userLogin:h,security_ls_key:LIVESTREET_SECURITY_KEY};var l=f.find('input[name="time"]');l.each(function(o,n){if(n.checked){m.time=n.value;}});var j=f.find('input[name="time_value"]');
if(j.length){m.time_value=j.val();}var k=f.find('input[name="reason"]');k.each(function(o,n){if(n.checked){m.reason=n.value;}});var j=f.find('input[name="reason_value"]');
if(j.length){m.reason_value=j.val();}a.ajax({url:"/profile/ajaxwarning/",type:"POST",data:m}).then(function(n){if(!n){msgErrorBox.alert("Error","Please try again later");
}if(n.bStateError){msgErrorBox.alert(n.sMsgTitle,n.sMsg);}else{document.location.reload();}});},onOpen:function(){var i=f.find('input[name="time"]');i.each(function(l,k){k.checked=false;
});i[0].checked=true;var j=f.find('input[name="reason"]');j.each(function(l,k){k.checked=false;});j[10].checked=true;f.on("click",function(k){f.find('input[name="time"]').each(function(m,l){if(l.checked){var n=f.find('input[name="time_value"]');
if(n.length){n[0].disabled=(l.value!="limited");}}});f.find('input[name="reason"]').each(function(m,l){if(l.checked){var n=f.find('input[name="reason_value"]');
if(n.length){n[0].disabled=(l.value!="0");}}});});},onClose:function(){f.off("click");},onCloseComplete:function(){this.destroy();}};var e=null;a.ajax({url:aRouter.profile+"ajaxwarning/",type:"GET",data:{userLogin:h,security_ls_key:LIVESTREET_SECURITY_KEY}}).then(function(i){if(!i.bStateError){if(a("#user_ban_dialog_tpl").length){a("#user_ban_dialog_tpl").remove();
}a("body").append(a(i.sHtml));f=a("#user_ban_dialog");g.content=f;e=new jBox("Confirm",g);e.open();}else{msgErrorBox.alert(i.sMsgTitle,i.sMsg);}});};window.unban=window.unwarn=function(e){var f={userLogin:e,security_ls_key:LIVESTREET_SECURITY_KEY};
a.ajax({url:"/profile/ajaxwarningclear/",type:"POST",data:f}).then(function(g){if(!g){msgErrorBox.alert("Error","Please try again later");}if(g.bStateError){msgErrorBox.alert(g.sMsgTitle,g.sMsg);
}else{if(g.sMsgTitle){msgNoticeBox.alert(g.sMsgTitle,g.sMsg);setTimeout(function(){document.location.reload();},1000);}else{document.location.reload();
}}});};var c=a("#login_pn");if(c){var d=a('<span title="IP адреса пользователя">(X)</span>').css({display:"inline-block",verticalAlign:"middle",marginLeft:"1em",cursor:"pointer",color:"#868894",fontSize:"16px",fontWeight:"normal"}).click(function(g){g.preventDefault();
var f=a("#login_ipn");if(f){f.css("display",(f.css("display")=="block")?"none":"block");}return false;}).appendTo(c);var b=a('<span title="Забанить или предупредить юзера">(Б)</span>').css({display:"inline-block",verticalAlign:"middle",marginLeft:"0.2em",cursor:"pointer",color:"#868894",fontSize:"16px",fontWeight:"normal"}).click(function(h){h.preventDefault();
var g=document.getElement('link[rel="canonical"]');if(g){var f=g.href.match(/\/profile\/([\da-z0-9\_\-]+)/i);if(f){window.ban(f[1]);}}return false;}).appendTo(c);
}});})(jQuery);